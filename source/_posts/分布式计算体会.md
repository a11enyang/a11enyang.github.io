---
title: 分布式计算体会
date: 2020-05-07 10:22:21
tags:
	- BUPT
	- 分布式计算
password: 123
---

# 接口与实现分离

最重要的一点，接口与实现分离。接口暴露客户端需要使用的方法，真正的实现的过程对于客户端是不可知的。降低项目的耦合性，同时能够更方便更新和修改。

## 注意点

* 以DLL的制造为背景进行编写
* 一开始，接口中是需要虚析构函数来进行子类资源的释放的，但是由于不同编译器对于虚析构函数的位置是不同的，所以放弃了接口类中的虚析构函数，而是采用默认的构造函数和虚析构函数
* 编写一个方法可以被客户调用进行资源释放
* 然后增加新的接口实现接口之间的转换
  * 接口的继承
  * 多接口的继承
* 引用计数



# COM接口

## 接口与对象之间的结构关系

<img src="/Users/austin/Documents/GitHub/图片/Picture/Picture/img2/image-20200507105848298.png" alt="士大夫" style="zoom:50%;" />

## COM对象与接口的标识符

对象与接口的标识符都是128位的随机字符，对象标识符叫`CLSID`;

接口标识符叫`IID`

## IUknown接口

所有COM接口都继承自IUknown接口，IUknown的两个重要特性

* 生存期控制：引用计数控制对象的生存周期
* 接口查询：实现接口之间的有效转换，接口之间的转换存在着等价性：对称性、自反性、传递性

![image-20200507143038410](/Users/austin/Documents/GitHub/图片/Picture/Picture/img2/image-20200507143038410.png)

# COM对象

## 注册表

系统注册表是全系统范围内公用的信息库，所有客户程序和组件程序都可以对其进行访问。组件程序把他实现的COM对象信息和接口信息保存到注册表中，这个过程称为注册。注册表是Windows操作系统的中心数据仓库。当组件程序安装到 机器上以后，必须把它的信息注册到注册表中，客户才能从表中 找到组件程序并对其进行操作。注册表可以看作是组件与客户的 中介。是COM实现位置透明性的关键